import{r as c,I as k,A as i,f as S,s as x,h as C,b as t,x as $,C as y,a as d,B as M,w as b,n as B,l as I,o as N,d as h,t as _}from"./app-BmMnv7Hf.js";import{_ as V}from"./Label-DWTE4-tY.js";import{_ as D}from"./Input-CLHvIp3o.js";import{_ as w}from"./InputError-CqlclkzZ.js";import{_ as R}from"./SecondaryButton-3_x4XnxO.js";import{_ as T}from"./Button-BWK-thSE.js";import j from"./WaitForKey-B88pVrrY.js";const q={class:"mt-4"},z={class:"mt-4"},A={class:"mt-5 flex items-center"},L={__name:"RegisterKey",props:{errorMessage:String,name:String,form:Object},emits:["start","stop","register","update:name"],setup(a,{emit:K}){const o=a,l=K,r=c(!1),n=c(o.errorMessage),v=c(null);k(()=>{o.form.reset(),i().then(()=>v.value.focus())}),S(()=>o.errorMessage,e=>{n.value=e});const u=x(()=>r.value===!0||o.form.processing),f=()=>{r.value=!0,n.value="",i().then(()=>l("start")),axios.post(route("webauthn.store.options")).then(e=>{e.data!==void 0?p(e.data.publicKey):i().then(()=>p(e.props.publicKey))}).catch(e=>{g(),n.value=e.response.data.errors[0]})},p=e=>{r.value===!0&&l("register",e)},g=()=>{r.value=!1,i().then(()=>l("stop"))};return(e,s)=>(N(),C("form",{onSubmit:I(f,["prevent"])},[t(w,{message:a.form.errors.register,class:"mt-2"},null,8,["message"]),$(d("div",q,[t(V,{for:"name",value:e.$t("Key name")},null,8,["value"]),t(D,{type:"text",class:"mt-1 block w-3/4",id:"name",ref_key:"nameInput",ref:v,value:a.name,onInput:s[0]||(s[0]=m=>e.$emit("update:name",m.target.value)),required:"",onKeyup:s[1]||(s[1]=M(m=>f(),["enter"]))},null,8,["value"]),t(w,{message:a.form.errors.name,class:"mt-2"},null,8,["message"])],512),[[y,!u.value||a.form.errors.name]]),$(d("div",z,[t(j,{"error-message":n.value,form:a.form,onRetry:s[2]||(s[2]=m=>f())},null,8,["error-message","form"])],512),[[y,r.value]]),d("div",A,[t(R,{onClick:s[3]||(s[3]=m=>g())},{default:b(()=>[h(_(e.$t("Cancel")),1)]),_:1}),t(T,{class:B(["ms-2",{"opacity-25":u.value}]),disabled:u.value},{default:b(()=>[h(_(e.$t("Submit")),1)]),_:1},8,["class","disabled"])])],32))}};export{L as default};
