import{P as T}from"./PrettyButton-DJ97II5T.js";import{P as v}from"./PrettySpan-DbeWKi_L.js";import{T as _}from"./TextInput-DPfNN3hz.js";import{E as x}from"./Errors-DkF-M9C7.js";import{H as g,h as l,a as r,d as S,t as u,c as w,j as d,l as p,b as n,n as c,F as M,k as C,o as a}from"./app-BmMnv7Hf.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={components:{PrettyButton:T,PrettySpan:v,TextInput:_,Errors:x},props:{layoutData:{type:Object,default:null},data:{type:Object,default:null}},data(){return{loadingState:"",createTagModalShown:!1,editTagModalShownId:0,localTags:[],form:{name:"",errors:[]}}},mounted(){this.localTags=this.data.tags},methods:{showLabelModal(){this.form.name="",this.createTagModalShown=!0,this.$nextTick().then(()=>{this.$refs.newTag.focus()})},updateTagModal(e){this.form.name=e.name,this.editTagModalShownId=e.id},submit(){this.loadingState="loading",axios.post(this.data.url.tag_store,this.form).then(e=>{this.flash(this.$t("The tag has been created"),"success"),this.localTags.unshift(e.data.data),this.loadingState=null,this.createTagModalShown=!1}).catch(e=>{this.loadingState=null,this.form.errors=e.response.data})},update(e){this.loadingState="loading",axios.put(e.url.update,this.form).then(t=>{this.flash(this.$t("The tag has been updated"),"success"),this.localTags[this.localTags.findIndex(h=>h.id===e.id)]=t.data.data,this.loadingState=null,this.editTagModalShownId=0}).catch(t=>{this.loadingState=null,this.form.errors=t.response.data})},destroy(e){confirm(this.$t("Are you sure? This action cannot be undone."))&&axios.delete(e.url.destroy).then(()=>{this.flash(this.$t("The tag has been deleted"),"success");var t=this.localTags.findIndex(h=>h.id===e.id);this.localTags.splice(t,1)}).catch(t=>{this.loadingState=null,this.form.errors=t.response.data})}}},j={class:"mb-12"},E={class:"mb-3 mt-8 items-center justify-between sm:mt-0 sm:flex"},N={class:"mb-4 sm:mb-0"},P={class:"border-b border-gray-200 p-5 dark:border-gray-700"},$={class:"flex justify-between p-5"},B={key:1,class:"mb-6 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},A={key:0,class:"flex items-center justify-between px-5 py-2"},D={class:"flex items-center text-base"},L={class:"me-2"},q={key:0,class:"text-xs text-gray-500"},F={class:"text-sm"},K=["onClick"],O={class:"text-blue-500 hover:underline"},U=["onClick"],z=["onSubmit"],H={class:"border-b border-gray-200 p-5 dark:border-gray-700"},R={class:"flex justify-between p-5"},G={key:2,class:"mb-6 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},J={class:"p-5 text-center"};function Q(e,t,h,W,s,m){const b=g("pretty-button"),f=g("errors"),y=g("text-input"),k=g("pretty-span");return a(),l("div",j,[r("div",E,[r("h3",N,[t[7]||(t[7]=r("span",{class:"me-1"}," âš¡ ",-1)),S(" "+u(e.$t("All the tags used in the vault")),1)]),s.createTagModalShown?d("",!0):(a(),w(b,{key:0,text:e.$t("Add a tag"),icon:"plus",onClick:m.showLabelModal},null,8,["text","onClick"]))]),s.createTagModalShown?(a(),l("form",{key:0,class:"mb-6 rounded-lg border border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-900",onSubmit:t[3]||(t[3]=p(o=>m.submit(),["prevent"]))},[r("div",P,[n(f,{errors:s.form.errors},null,8,["errors"]),n(y,{ref:"newTag",modelValue:s.form.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.form.name=o),label:e.$t("Name"),type:"text",autofocus:!0,"input-class":"block w-full",required:!0,autocomplete:!1,maxlength:255,class:c("mb-4"),onEscKeyPressed:t[1]||(t[1]=o=>s.createTagModalShown=!1)},null,8,["modelValue","label"])]),r("div",$,[n(k,{text:e.$t("Cancel"),class:c("me-3"),onClick:t[2]||(t[2]=o=>s.createTagModalShown=!1)},null,8,["text"]),n(b,{text:e.$t("Save"),state:s.loadingState,icon:"plus",class:c("save")},null,8,["text","state"])])],32)):d("",!0),s.localTags.length>0?(a(),l("ul",B,[(a(!0),l(M,null,C(s.localTags,o=>(a(),l("li",{key:o.id,class:"item-list border-b border-gray-200 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 hover:dark:bg-slate-800 hover:dark:bg-slate-900"},[s.editTagModalShownId!==o.id?(a(),l("div",A,[r("span",D,[r("span",L,u(o.name),1),o.count>0?(a(),l("span",q,"("+u(e.$tChoice(":count post|:count posts",o.count,{count:o.count}))+")",1)):d("",!0)]),r("ul",F,[r("li",{class:"me-4 inline cursor-pointer",onClick:i=>m.updateTagModal(o)},[r("span",O,u(e.$t("Edit")),1)],8,K),r("li",{class:"inline cursor-pointer text-red-500 hover:text-red-900 hover:dark:text-red-100",onClick:i=>m.destroy(o)},u(e.$t("Delete")),9,U)])])):d("",!0),s.editTagModalShownId===o.id?(a(),l("form",{key:1,class:"item-list border-b border-gray-200 bg-gray-50 hover:bg-slate-50 dark:border-gray-700 dark:bg-gray-900 dark:bg-slate-900 hover:dark:bg-slate-800 hover:dark:bg-slate-900",onSubmit:p(i=>m.update(o),["prevent"])},[r("div",H,[n(f,{errors:s.form.errors},null,8,["errors"]),n(y,{ref_for:!0,ref:"rename",modelValue:s.form.name,"onUpdate:modelValue":t[4]||(t[4]=i=>s.form.name=i),label:e.$t("Name"),type:"text",autofocus:!0,"input-class":"block w-full",required:!0,autocomplete:!1,maxlength:255,class:c("mb-4"),onEscKeyPressed:t[5]||(t[5]=i=>s.editTagModalShownId=0)},null,8,["modelValue","label"])]),r("div",R,[n(k,{text:e.$t("Cancel"),class:c("me-3"),onClick:t[6]||(t[6]=p(i=>s.editTagModalShownId=0,["prevent"]))},null,8,["text"]),n(b,{text:e.$t("Rename"),state:s.loadingState,icon:"check",class:c("save")},null,8,["text","state"])])],40,z)):d("",!0)]))),128))])):d("",!0),s.localTags.length===0?(a(),l("div",G,[r("p",J,u(e.$t("Tags let you classify journal posts using a system that matters to you.")),1)])):d("",!0)])}const oe=I(V,[["render",Q],["__scopeId","data-v-6add9eab"]]);export{oe as default};
