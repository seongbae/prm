import{r as c,T as E,h as b,a as o,u as t,b as s,j as f,x as n,bP as y,t as u,C as g,w as B,n as k,y as N,l as T,A as v,o as h,P as Y,by as O,c1 as R}from"./app-BmMnv7Hf.js";import{D as A}from"./style-ClCZSOx6.js";import{P as z}from"./PrettyButton-DJ97II5T.js";import{P as H}from"./PrettySpan-DbeWKi_L.js";import{T as $}from"./TextInput-DPfNN3hz.js";import{D as _}from"./Dropdown-fLyjUirY.js";import{E as K}from"./Errors-DkF-M9C7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"border-b border-gray-200 dark:border-gray-700"},G={key:0,class:"p-5"},J={class:"border-b border-gray-200 p-5 dark:border-gray-700"},L={class:"border-b border-gray-200 p-5 dark:border-gray-700"},Q={class:"p-5"},W={class:"mb-2 flex items-center"},X={for:"full_date",class:"ms-3 block cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300"},Z={class:"mb-4 ms-6"},ee=["value"],te={class:"mb-2 flex items-center"},ae={for:"month_day",class:"ms-3 block cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300"},re={class:"ms-6 flex"},oe={class:"mb-2 flex items-center"},le={for:"year",class:"ms-3 block cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300"},de={class:"ms-6"},se={key:1,class:"border-t border-gray-200 p-5 dark:border-gray-700"},ne={class:"flex items-center"},ie={for:"reminder",class:"ms-2 block cursor-pointer text-sm text-gray-900 dark:text-gray-100"},ue={key:0,class:"ms-4 mt-4"},me={class:"mb-2 flex items-center"},ce={for:"recurring_year",class:"ms-3 block cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300"},ye={class:"flex items-center"},pe={for:"one_time",class:"ms-3 block cursor-pointer text-sm font-medium text-gray-700 dark:text-gray-300"},be={class:"flex justify-between p-5"},Ve={__name:"CreateOrEditImportantDate",props:{date:Object,data:Object},emits:["close","created","update:date"],setup(m,{expose:C,emit:D}){const q=D,d=m,x=c(null),w=c(null),V=c(null),p=c(null),e=E({choice:"full_date",month:"",day:"",label:"",date:"",age:"",contact_important_date_type_id:null,reminder:!1,reminderChoice:"recurring_year",errors:[]}),U=c({modelValue:"YYYY-MM-DD"}),I=()=>{d.date?(e.choice=d.date.choice,e.month=d.date.month,e.day=d.date.day,e.label=d.date.label,e.date=d.date.completeDate,e.age=d.date.age,e.contact_important_date_type_id=d.date.type?d.date.type.id:0):(e.choice="full_date",e.month="",e.day="",e.label="",e.date="",e.age="",e.contact_important_date_type_id=0,e.reminderChoice="recurring_year"),v().then(()=>V.value.focus())},M=()=>{v().then(()=>x.value.focus())},P=()=>{v().then(()=>w.value.focus())},S=()=>{p.value="loading";let l={method:"post",url:d.data.url.store,data:e},a="created";d.date&&(l.method="put",l.url=d.date.url.update,a="update:date"),axios.request(l).then(i=>{p.value=null,q(a,i.data.data)}).catch(i=>{p.value=null,e.errors=i.response.data})};return C({reset:()=>I()}),(l,a)=>{var i;return h(),b("form",{class:"rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900",onSubmit:T(S,["prevent"])},[o("div",F,[t(e).errors.length>0?(h(),b("div",G,[s(K,{errors:t(e).errors},null,8,["errors"])])):f("",!0),o("div",J,[s($,{ref_key:"label",ref:V,modelValue:t(e).label,"onUpdate:modelValue":a[0]||(a[0]=r=>t(e).label=r),label:l.$t("Name"),type:"text",autofocus:!0,"input-class":"block w-full",required:!0,autocomplete:!1,maxlength:255,onEscKeyPressed:a[1]||(a[1]=r=>l.$emit("close"))},null,8,["modelValue","label"])]),o("div",L,[s(_,{modelValue:t(e).contact_important_date_type_id,"onUpdate:modelValue":a[2]||(a[2]=r=>t(e).contact_important_date_type_id=r),data:m.data.date_types,required:!1,placeholder:l.$t("Choose a value"),"dropdown-class":"block w-full",help:l.$t("Some dates have a special type that we will use in the software to calculate an age."),label:l.$t("Date type")},null,8,["modelValue","data","placeholder","help","label"])]),o("div",Q,[o("div",W,[n(o("input",{id:"full_date","onUpdate:modelValue":a[3]||(a[3]=r=>t(e).choice=r),value:"full_date",name:"date",type:"radio",class:"h-4 w-4 border-gray-300 text-sky-500 dark:border-gray-700"},null,512),[[y,t(e).choice]]),o("label",X,u(l.$t("I know the exact date, including the year")),1)]),n(o("div",Z,[s(t(A),{modelValue:t(e).date,"onUpdate:modelValue":a[4]||(a[4]=r=>t(e).date=r),modelModifiers:{string:!0},class:"inline-block h-full",masks:U.value,locale:(i=l.$page.props.auth.user)==null?void 0:i.locale_ietf,"is-dark":t(R)(),"update-on-input":!1},{default:B(({inputValue:r,inputEvents:j})=>[o("input",Y({class:"rounded border bg-white px-2 py-1 dark:bg-gray-900",value:r},O(j,!0)),null,16,ee)]),_:1},8,["modelValue","masks","locale","is-dark"])],512),[[g,t(e).choice==="full_date"]]),o("div",te,[n(o("input",{id:"month_day","onUpdate:modelValue":a[5]||(a[5]=r=>t(e).choice=r),value:"month_day",name:"date",type:"radio",class:"h-4 w-4 border-gray-300 text-sky-500 dark:border-gray-700",onInput:P},null,544),[[y,t(e).choice]]),o("label",ae,u(l.$t("I only know the day and month, not the year")),1)]),n(o("div",re,[s(_,{ref_key:"monthInput",ref:w,modelValue:t(e).month,"onUpdate:modelValue":a[6]||(a[6]=r=>t(e).month=r),modelModifiers:{number:!0},data:m.data.months,required:t(e).choice==="month_day",class:k("mb-5 me-2"),placeholder:l.$t("Choose a value"),"dropdown-class":"block w-full",label:l.$t("Month")},null,8,["modelValue","data","required","placeholder","label"]),s(_,{modelValue:t(e).day,"onUpdate:modelValue":a[7]||(a[7]=r=>t(e).day=r),modelModifiers:{number:!0},data:m.data.days,required:t(e).choice==="month_day",class:k("mb-5"),placeholder:l.$t("Choose a value"),"dropdown-class":"block w-full",label:l.$t("Day")},null,8,["modelValue","data","required","placeholder","label"])],512),[[g,t(e).choice==="month_day"]]),o("div",oe,[n(o("input",{id:"year","onUpdate:modelValue":a[8]||(a[8]=r=>t(e).choice=r),value:"year",name:"date",type:"radio",class:"h-4 w-4 border-gray-300 text-sky-500 dark:border-gray-700",onInput:M},null,544),[[y,t(e).choice]]),o("label",le,u(l.$t("I only know a number of years (an age, for example)")),1)]),n(o("div",de,[s($,{ref_key:"ageInput",ref:x,modelValue:t(e).age,"onUpdate:modelValue":a[9]||(a[9]=r=>t(e).age=r),modelModifiers:{number:!0},type:"number",min:0,max:120,"input-class":"block",required:t(e).choice==="year",autocomplete:!1},null,8,["modelValue","required"])],512),[[g,t(e).choice==="year"]])]),m.date===void 0&&t(e).choice!=="year"?(h(),b("div",se,[o("div",ne,[n(o("input",{id:"reminder","onUpdate:modelValue":a[10]||(a[10]=r=>t(e).reminder=r),name:"reminder",type:"checkbox",class:"focus:ring-3 relative h-4 w-4 rounded border border-gray-300 bg-gray-50 focus:ring-blue-300 dark:border-gray-600 dark:bg-gray-700 dark:ring-offset-gray-800 focus:dark:ring-blue-600"},null,512),[[N,t(e).reminder]]),o("label",ie,u(l.$t("Create a reminder")),1)]),t(e).reminder?(h(),b("div",ue,[o("div",me,[n(o("input",{id:"recurring_year","onUpdate:modelValue":a[11]||(a[11]=r=>t(e).reminderChoice=r),value:"recurring_year",name:"reminder-frequency",type:"radio",class:"h-4 w-4 border-gray-300 text-sky-500 dark:border-gray-700"},null,512),[[y,t(e).reminderChoice]]),o("label",ce,u(l.$t("Remind me about this date every year")),1)]),o("div",ye,[n(o("input",{id:"one_time","onUpdate:modelValue":a[12]||(a[12]=r=>t(e).reminderChoice=r),value:"one_time",name:"reminder-frequency",type:"radio",class:"h-4 w-4 border-gray-300 text-sky-500 dark:border-gray-700"},null,512),[[y,t(e).reminderChoice]]),o("label",pe,u(l.$t("Remind me about this date just once, in one year from now")),1)])])):f("",!0)])):f("",!0)]),o("div",be,[s(H,{text:l.$t("Cancel"),classes:"me-3",onClick:a[13]||(a[13]=r=>l.$emit("close"))},null,8,["text"]),s(z,{text:l.$t("Save"),state:p.value,icon:"check",class:k("save")},null,8,["text","state"])])],32)}}};export{Ve as default};
