import{r as b,T as N,s as T,f as z,I as E,v as I,q as P,h as l,a as t,t as a,c as $,j as d,l as x,b as m,u,d as k,n as S,w as V,m as _,p as g,o as r,i as O}from"./app-BmMnv7Hf.js";import{P as M}from"./PrettyButton-DJ97II5T.js";import{P as Y}from"./PrettySpan-DbeWKi_L.js";import{E as U}from"./Errors-DkF-M9C7.js";import{D as C}from"./Dropdown-fLyjUirY.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as L}from"./index-BX-obcj7.js";const G={class:"mb-3 flex items-center justify-between"},H={class:"dark:text-gray-200"},J={class:"border-b border-gray-200 p-5 dark:border-gray-700"},K={class:"mb-2 block text-sm"},Q={class:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300"},R={class:"me-2"},X={class:"border-b border-gray-200 p-5 dark:border-gray-700"},Z={class:"mb-4 font-semibold"},ee={class:"ms-4 list-decimal"},te={class:"mb-2"},se={class:"mb-2"},ae={class:"flex justify-between p-5"},oe={key:1,class:"mb-6 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},re={class:"p-5 text-center"},le={key:2},ne={key:0},ie={class:"flex items-center justify-between rounded-lg border border-gray-200 px-5 py-2 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 hover:dark:bg-slate-800"},de={class:"flex items-center"},ue={key:0,class:"mb-0 block"},ce={key:0},me={class:"mb-4 font-semibold"},he={class:"ms-4 list-decimal"},pe={class:"mb-2"},ve=["href"],be={class:"mb-2"},ge={class:"mt-4 text-sm"},fe={key:1,class:"text-sm"},ye={key:1,class:"me-4 inline"},ke={class:"me-4 inline cursor-pointer text-blue-500 hover:underline"},_e={key:1,class:"mb-6 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},we={class:"p-5 text-center"},Te={__name:"Telegram",props:{data:Object},setup(q){const h=q,p=b(""),o=b(h.data.telegram.data),f=b(h.data.telegram.telegram_env_variable_set),v=b(!1),y=b(!1),n=N({content:"",label:"",hours:9,minutes:0,errors:[]}),j=T(()=>{let e=[];for(let s=0;s<24;s++){let i=s.toString().padStart(2,"0");e.push({id:s,name:i})}return e}),B=T(()=>{let e=[];for(let s=0;s<60;s+=5){let i=s.toString().padStart(2,"0");e.push({id:s,name:i})}return e});z(()=>h.data,()=>{o.value=h.data.telegram.data,o.value&&o.value.active&&c.cancel()}),E(()=>{o.value&&!o.value.active&&c()});const W=()=>{n.label="",v.value=!0},A=()=>{axios.post(o.value.url.send_test).then(()=>{_(g("The notification has been sent"),"success"),y.value=!0}).catch(e=>{n.errors=e.response.data})},D=()=>{p.value="loading",axios.post(h.data.url.store_telegram,n.data()).then(e=>{_(g("The channel has been added"),"success"),o.value=e.data.data,p.value=null,v.value=!1,c()}).catch(e=>{p.value=null,n.errors=e.response.data})},c=I.debounce(()=>{P.reload({only:["data"]}),c()},2e3),w=()=>{confirm(g("Are you sure? This action cannot be undone."))&&axios.delete(o.value.url.destroy).then(()=>{_(g("The Telegram channel has been deleted"),"success"),o.value=null,c.cancel()}).catch(e=>{p.value=null,n.errors=e.response.data,c.cancel()})};return(e,s)=>(r(),l("div",null,[t("div",G,[t("span",H,a(e.$t("Via Telegram")),1),!v.value&&!o.value&&f.value?(r(),$(M,{key:0,text:e.$t("Setup Telegram"),icon:"plus",onClick:W},null,8,["text"])):d("",!0)]),v.value?(r(),l("form",{key:0,class:"item-list mb-6 rounded-lg border border-b border-gray-200 bg-gray-50 hover:bg-slate-50 dark:border-gray-700 dark:bg-gray-900 dark:bg-slate-900 hover:dark:bg-slate-800",onSubmit:s[3]||(s[3]=x(i=>D(),["prevent"]))},[t("div",J,[m(U,{errors:u(n).errors},null,8,["errors"]),t("p",K,a(e.$t("At which time should we send the notification, when the reminder occurs?")),1),t("div",Q,[t("span",R,a(e.$t("At")),1),m(C,{modelValue:u(n).hours,"onUpdate:modelValue":s[0]||(s[0]=i=>u(n).hours=i),"dropdown-class":"me-1",required:e.required,data:j.value},null,8,["modelValue","required","data"]),s[4]||(s[4]=t("span",{class:"me-2"},":",-1)),m(C,{modelValue:u(n).minutes,"onUpdate:modelValue":s[1]||(s[1]=i=>u(n).minutes=i),"dropdown-class":"me-1",required:e.required,data:B.value},null,8,["modelValue","required","data"])])]),t("div",X,[t("p",Z,[s[5]||(s[5]=t("span",{class:"me-1"},"ðŸ‘‹",-1)),k(" "+a(e.$t("What happens now?")),1)]),t("ol",ee,[t("li",te,a(e.$t("Once you click the Setup button below, youâ€™ll have to open Telegram with the button weâ€™ll provide you with. This will locate the Monica Telegram bot for you.")),1),t("li",se,a(e.$t("Type anything in the conversation with the Monica bot. It can be `start` for instance.")),1),t("li",null,a(e.$t("Wait a few seconds for Monica (the application) to recognize you. Weâ€™ll send you a fake notification to see if it works.")),1)])]),t("div",ae,[m(Y,{text:e.$t("Cancel"),class:S("me-3"),onClick:s[2]||(s[2]=x(i=>v.value=!1,["prevent"]))},null,8,["text"]),m(M,{text:e.$t("Setup"),state:p.value,icon:"check",class:S("save")},null,8,["text","state"])])],32)):d("",!0),f.value?d("",!0):(r(),l("div",oe,[t("p",re,a(e.$t("You have not setup Telegram in your environment variables yet.")),1)])),f.value?(r(),l("div",le,[o.value?(r(),l("div",ne,[t("div",ie,[t("div",de,[o.value.active?(r(),$(u(L),{key:0,placement:"topLeft",title:"Verified","arrow-point-at-center":""},{default:V(()=>s[6]||(s[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"me-2 inline h-4 w-4 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)])),_:1})):d("",!0),t("div",null,[o.value.active?(r(),l("span",ue,a(e.$t("Your account is linked")),1)):d("",!0)])]),o.value.active?(r(),l("ul",fe,[y.value?d("",!0):(r(),l("li",{key:0,class:"me-4 inline cursor-pointer text-blue-500 hover:underline",onClick:A},a(e.$t("Send test")),1)),y.value?(r(),l("li",ye,a(e.$t("Notification sent")),1)):d("",!0),t("li",ke,[m(u(O),{href:o.value.url.logs,class:"text-blue-500 hover:underline"},{default:V(()=>[k(a(e.$t("View log")),1)]),_:1},8,["href"])]),t("li",{class:"inline cursor-pointer text-red-500 hover:text-red-900",onClick:w},a(e.$t("Delete")),1)])):(r(),l("div",ce,[t("p",me,[s[7]||(s[7]=t("span",{class:"me-1"},"ðŸ‘‹",-1)),k(" "+a(e.$t("What happens now?")),1)]),t("ol",he,[t("li",pe,[t("a",{href:o.value.url.open,target:"_blank",class:"text-blue-500 hover:underline",rel:"noopener noreferrer"},a(e.$t("Open Telegram to validate your identity")),9,ve)]),t("li",be,a(e.$t("Type anything in the conversation with the Monica bot. It can be `start` for instance.")),1),t("li",null,a(e.$t("Wait a few seconds for Monica (the application) to recognize you. Weâ€™ll send you a fake notification to see if it works.")),1)]),t("ul",ge,[t("li",{class:"inline cursor-pointer text-red-500 hover:text-red-900",onClick:w},a(e.$t("Delete")),1)])]))])])):(r(),l("div",_e,[t("p",we,a(e.$t("You havenâ€™t setup Telegram yet.")),1)]))])):d("",!0)]))}},je=F(Te,[["__scopeId","data-v-9bf12221"]]);export{je as default};
