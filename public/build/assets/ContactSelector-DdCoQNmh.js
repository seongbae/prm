import{p as V,r as b,T as K,s as $,I as D,f as F,o as r,h as a,a as s,d as p,t as o,j as i,F as k,k as f,b as B,w as L,u,i as z,x as R,bO as O,n as P,B as G,A as x}from"./app-BmMnv7Hf.js";import{E as H}from"./Errors-DkF-M9C7.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={key:0,class:"mb-2 block text-sm"},W={key:0,class:"optional-badge rounded px-[3px] py-px text-xs"},X={key:1,class:"mb-4 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},Y={class:"text-sm"},Z=["onClick"],ee={key:0},te={class:"relative mb-3"},re=["type","name","required","placeholder"],ae={key:0,class:"length absolute rounded text-xs"},se={key:0,class:"mb-6"},le={class:"mb-2 mt-2 text-center text-sm text-gray-600 dark:text-gray-400"},oe={class:"rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},de={class:"text-sm"},ne=["onClick"],ie={key:1,class:"mb-6 rounded-lg border border-gray-200 bg-white p-6 text-center text-gray-500 dark:border-gray-700 dark:bg-gray-900"},ue={key:2,class:"mb-6 rounded-lg border border-gray-200 bg-white p-6 text-center text-gray-500 dark:border-gray-700 dark:bg-gray-900"},ce={key:3,class:"mb-3"},ge={class:"mb-4 rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-900"},he={class:"text-sm"},be=["onClick"],ye={key:4,class:"mb-3 rounded-lg border border-gray-200 bg-white p-6 text-center text-gray-500 dark:border-gray-700 dark:bg-gray-900"},me={__name:"ContactSelector",props:{modelValue:{type:Array,default:()=>[]},inputClass:String,placeholder:{type:String,default:()=>V("Find a contact in this vault")},label:String,labelCta:{type:String,default:()=>V("+ add a contact")},type:{type:String,default:"text"},required:Boolean,displayMostConsultedContacts:Boolean,addMultipleContacts:Boolean,searchUrl:String,mostConsultedContactsUrl:String},emits:["update:modelValue"],setup(c,{emit:I}){const g=c,C=I,w=b(null),y=b(!1),m=b(!1),d=b(g.modelValue),T=b([]),h=b([]),l=K({searchTerm:"",errors:[]}),A=$(()=>!g.addMultipleContacts&&d.value.length>=1?!1:!y.value),j=$(()=>["ps-8 w-full rounded-md shadow-sm","bg-white dark:bg-slate-900 border-gray-300 dark:border-gray-700","focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50","disabled:bg-slate-50 disabled:dark:bg-slate-900",g.inputClass]);D(()=>{g.displayMostConsultedContacts&&U()}),F(()=>g.modelValue,e=>{d.value=e});const q=()=>{y.value=!0,l.searchTerm="",x().then(()=>w.value.focus())},N=()=>{v.cancel(),y.value=!1},U=()=>{axios.get(g.mostConsultedContactsUrl).then(e=>{T.value=e.data.data})},M=e=>{d.value.findIndex(t=>t.id===e.id)===-1&&(d.value.push(e),l.searchTerm="",y.value=!1,x().then(()=>C("update:modelValue",d.value)))},E=e=>{let n=d.value.findIndex(t=>t.id===e.id);d.value.splice(n,1),x().then(()=>C("update:modelValue",d.value))},v=_.debounce(()=>{l.searchTerm!==""&&l.searchTerm.length>=3?(m.value=!0,axios.post(g.searchUrl,l).then(e=>{h.value=_.filter(e.data.data,n=>_.every(d.value,t=>n.id!==t.id)),m.value=!1}).catch(e=>{l.errors=e.response.data,m.value=!1})):h.value=[]},300);return(e,n)=>(r(),a("div",null,[s("div",null,[c.label?(r(),a("label",Q,[p(o(c.label)+" ",1),c.required?i("",!0):(r(),a("span",W,o(e.$t("optional")),1))])):i("",!0),d.value.length>0?(r(),a("ul",X,[(r(!0),a(k,null,f(d.value,t=>(r(),a("li",{key:t.id,class:"item-list flex items-center justify-between border-b border-gray-200 px-3 py-2 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 hover:dark:bg-slate-800"},[B(u(z),{href:t.url},{default:L(()=>[p(o(t.name),1)]),_:2},1032,["href"]),s("ul",Y,[s("li",{class:"inline cursor-pointer text-blue-500 hover:underline",onClick:S=>E(t)},o(e.$t("Remove")),9,Z)])]))),128))])):i("",!0),A.value?(r(),a("p",{key:2,class:"inline-block cursor-pointer rounded-lg border bg-slate-200 px-1 py-1 text-xs hover:bg-slate-300 dark:border-gray-700 dark:bg-slate-500 dark:text-gray-900 hover:dark:bg-slate-700",onClick:q},o(c.labelCta),1)):i("",!0)]),y.value?(r(),a("div",ee,[s("div",te,[n[2]||(n[2]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"absolute start-2 top-[13px] h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),R(s("input",{ref_key:"searchInput",ref:w,"onUpdate:modelValue":n[0]||(n[0]=t=>u(l).searchTerm=t),class:P(j.value),type:c.type,name:e.name,required:c.required,placeholder:c.placeholder,onKeyup:n[1]||(n[1]=(...t)=>u(v)&&u(v)(...t)),onKeydown:G(N,["esc"])},null,42,re),[[O,u(l).searchTerm]]),e.maxlength&&e.displayMaxLength?(r(),a("span",ae,o(e.charactersLeft),1)):i("",!0)]),d.value.length===0&&c.displayMostConsultedContacts&&h.value.length===0&&u(l).searchTerm.length===0?(r(),a("div",se,[s("p",le,o(e.$t("Maybe one of these contacts?")),1),s("ul",oe,[(r(!0),a(k,null,f(T.value,t=>(r(),a("li",{key:t.id,class:"item-list flex items-center justify-between border-b border-gray-200 px-3 py-2 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 hover:dark:bg-slate-800"},[p(o(t.name)+" ",1),s("ul",de,[s("li",{class:"inline cursor-pointer text-blue-500 hover:underline",onClick:S=>M(t)},o(e.$t("Add")),9,ne)])]))),128))])])):i("",!0),m.value?(r(),a("div",ie,[s("p",null,o(e.$t("Searchingâ€¦")),1)])):i("",!0),u(l).searchTerm.length<3&&u(l).searchTerm.length!==0?(r(),a("div",ue,[s("p",null,o(e.$t("Please enter at least 3 characters to initiate a search.")),1)])):i("",!0),h.value.length!==0&&u(l).searchTerm.length!==0?(r(),a("div",ce,[B(H,{errors:u(l).errors},null,8,["errors"]),s("ul",ge,[(r(!0),a(k,null,f(h.value,t=>(r(),a("li",{key:t.id,class:"item-list flex items-center justify-between border-b border-gray-200 px-3 py-2 hover:bg-slate-50 dark:border-gray-700 dark:bg-slate-900 hover:dark:bg-slate-800"},[p(o(t.name)+" ",1),s("ul",he,[s("li",{class:"inline cursor-pointer text-blue-500 hover:underline",onClick:S=>M(t)},o(e.$t("Add")),9,be)])]))),128))])])):i("",!0),h.value.length===0&&u(l).searchTerm.length>=3?(r(),a("div",ye,[s("p",null,o(e.$t("No results found")),1)])):i("",!0)])):i("",!0)]))}},fe=J(me,[["__scopeId","data-v-a727e6c2"]]);export{fe as C};
